<div class="container">
  <h2>Gestión de Clientes</h2>

  <!-- Mensaje -->
  <div *ngIf="mensaje" class="mensaje" [class.mensaje-success]="mensajeTipo === 'success'" [class.mensaje-error]="mensajeTipo === 'error'">
    {{ mensaje }}
  </div>

  <!-- Búsqueda rápida -->
  <div class="search-box">
    <input 
      type="text" 
      [(ngModel)]="busqueda" 
      placeholder="Buscar por nombre, identificación o teléfono..." 
      class="search-input">
  </div>

  <!-- Formulario -->
  <div class="form-section">
    <h3>{{ modoEdicion ? 'Editar Cliente' : 'Nuevo Cliente' }}</h3>
    <form (ngSubmit)="guardarCliente()" class="form-grid">
      <div class="form-group">
        <label>Nombre *</label>
        <input type="text" [(ngModel)]="nuevoCliente.nombre" name="nombre" required>
      </div>

      <div class="form-group">
        <label>Género *</label>
        <select [(ngModel)]="nuevoCliente.genero" name="genero" required>
          <option value="">Seleccione...</option>
          <option value="Masculino">Masculino</option>
          <option value="Femenino">Femenino</option>
          <option value="Otro">Otro</option>
        </select>
      </div>

      <div class="form-group">
        <label>Edad *</label>
        <input type="number" [(ngModel)]="nuevoCliente.edad" name="edad" required min="18">
      </div>

      <div class="form-group">
        <label>Identificación *</label>
        <input type="text" [(ngModel)]="nuevoCliente.identificacion" name="identificacion" required>
      </div>

      <div class="form-group">
        <label>Dirección *</label>
        <input type="text" [(ngModel)]="nuevoCliente.direccion" name="direccion" required>
      </div>

      <div class="form-group">
        <label>Teléfono *</label>
        <input type="tel" [(ngModel)]="nuevoCliente.telefono" name="telefono" required>
      </div>

      <div class="form-group">
        <label>Contraseña {{ modoEdicion ? '' : '*' }}</label>
        <input type="password" [(ngModel)]="nuevoCliente.contrasena" name="contrasena" [required]="!modoEdicion" placeholder="{{ modoEdicion ? 'Dejar vacío para no cambiar' : '' }}">
        <small *ngIf="modoEdicion" class="password-hint">Dejar vacío si no desea cambiar la contraseña</small>
      </div>

      <div class="form-group">
        <label>Estado</label>
        <select [(ngModel)]="nuevoCliente.estado" name="estado">
          <option [value]="true">Activo</option>
          <option [value]="false">Inactivo</option>
        </select>
      </div>

      <div class="form-actions">
        <button type="submit" class="btn btn-primary">
          {{ modoEdicion ? 'Actualizar' : 'Guardar' }}
        </button>
        <button type="button" class="btn btn-secondary" (click)="cancelar()" *ngIf="modoEdicion">
          Cancelar
        </button>
      </div>
    </form>
  </div>

  <!-- Tabla de clientes -->
  <div class="table-section">
    <h3>Lista de Clientes ({{ clientesFiltrados.length }})</h3>
    <div class="table-responsive">
      <table>
        <thead>
          <tr>
            <th>ID</th>
            <th>Nombre</th>
            <th>Género</th>
            <th>Edad</th>
            <th>Identificación</th>
            <th>Dirección</th>
            <th>Teléfono</th>
            <th>Estado</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let cliente of clientesFiltrados">
            <td>{{ cliente.clienteId }}</td>
            <td>{{ cliente.nombre }}</td>
            <td>{{ cliente.genero }}</td>
            <td>{{ cliente.edad }}</td>
            <td>{{ cliente.identificacion }}</td>
            <td>{{ cliente.direccion }}</td>
            <td>{{ cliente.telefono }}</td>
            <td>
              <span class="badge" [class.badge-active]="cliente.estado" [class.badge-inactive]="!cliente.estado">
                {{ cliente.estado ? 'Activo' : 'Inactivo' }}
              </span>
            </td>
            <td class="actions">
              <button class="btn btn-edit" (click)="seleccionarCliente(cliente)">
                <span class="material-icons">edit</span>
                Editar
              </button>
              <button class="btn btn-delete" (click)="eliminarCliente(cliente.clienteId!)">
                <span class="material-icons">delete</span>
                Eliminar
              </button>
            </td>
          </tr>
          <tr *ngIf="clientesFiltrados.length === 0">
            <td colspan="9" class="no-data">No se encontraron clientes</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
